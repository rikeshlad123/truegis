<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TrueGIS Inkmap Basic Print</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      background: #f4f4f4;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 { margin-top: 20px; }
    textarea {
      width: 90%;
      height: 300px;
      margin: 20px 0;
      font-family: monospace;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      margin-bottom: 40px;
    }
  </style>
</head>
<body>
  <h1>üó∫Ô∏è TrueGIS Inkmap Printer</h1>
  <textarea id="spec">
{
  "layers": [
    {
      "type": "WMTS",
      "url": "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.pixelkarte-farbe/default/current/2056/{TileMatrix}/{TileCol}/{TileRow}.jpeg",
      "tileGrid": {
        "resolutions": [4000,3750,3500,3250,3000,2750,2500,2250,2000,1750,1500,1250,1000,750,650,500,250,100,50,20],
        "origin": [2420000, 1350000]
      },
      "matrixSet": "EPSG:2056",
      "projection": "EPSG:2056",
      "attribution": "¬© Swisstopo"
    }
  ],
  "size": [210, 297, "mm"],
  "center": [2600000, 1200000],
  "dpi": 150,
  "scale": 25000,
  "projection": "EPSG:2056"
}
  </textarea>
  <button onclick="runPrint()">Print Map</button>

  <script type="module">
    import { print, downloadBlob } from 'https://cdn.jsdelivr.net/npm/@camptocamp/inkmap@3.0.0/+esm';

    window.runPrint = async function () {
      const text = document.getElementById('spec').value;
      try {
        const spec = JSON.parse(text);
        const blob = await print(spec);
        downloadBlob(blob, 'inkmap-output.png');
      } catch (err) {
        alert('‚ùå Print failed: ' + err.message);
        console.error(err);
      }
    };
  </script>
</body>
</html>
